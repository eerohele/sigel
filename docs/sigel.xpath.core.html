<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>sigel.xpath.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Sigel</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sigel</span></div></div></li><li class="depth-2 branch"><a href="sigel.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="sigel.extension.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extension</span></div></a></li><li class="depth-2 branch"><a href="sigel.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-2 branch"><a href="sigel.saxon.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>saxon</span></div></a></li><li class="depth-2 branch"><a href="sigel.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xpath</span></div></div></li><li class="depth-3 current"><a href="sigel.xpath.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>xslt</span></div></div></li><li class="depth-3 branch"><a href="sigel.xslt.components.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>components</span></div></a></li><li class="depth-3 branch"><a href="sigel.xslt.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3"><a href="sigel.xslt.elements.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>elements</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="sigel.xpath.core.html#var-*compiler*"><div class="inner"><span>*compiler*</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var--.3Eseq"><div class="inner"><span>-&gt;seq</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-compiler"><div class="inner"><span>compiler</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-declare-namespace.21"><div class="inner"><span>declare-namespace!</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-declare-variables.21"><div class="inner"><span>declare-variables!</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-default-namespace"><div class="inner"><span>default-namespace</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-early-evaluation-context"><div class="inner"><span>early-evaluation-context</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-is.3F"><div class="inner"><span>is?</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-match"><div class="inner"><span>match</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-matches.3F"><div class="inner"><span>matches?</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-ns"><div class="inner"><span>ns</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-package-data"><div class="inner"><span>package-data</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-pattern"><div class="inner"><span>pattern</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-select"><div class="inner"><span>select</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-set-default-namespace.21"><div class="inner"><span>set-default-namespace!</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-set-variable"><div class="inner"><span>set-variable</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-static-context"><div class="inner"><span>static-context</span></div></a></li><li class="depth-1"><a href="sigel.xpath.core.html#var-value-of"><div class="inner"><span>value-of</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">sigel.xpath.core</h1><div class="doc"><div class="markdown"><p>Functions for selecting and matching things in an XML file with XPath.</p>
<p>For examples, see the function-specific documentation for each function. The examples assume you’ve required this namespace:</p>
<pre><code>(require '[sigel.xpath.core :as xpath])
</code></pre>
<p>Every function in the <code>sigel.xpath.core</code> namespace that select or match things in an XML document rely on an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p>
<p>If you don’t pass in your own <code>XPathCompiler</code> as the first argument to a function like that, they use <a href="sigel.xpath.core.html#var-*compiler*"><code>*compiler*</code></a>.</p>
<h2><a href="#use-variables-in-xpath-expression-or-pattern" name="use-variables-in-xpath-expression-or-pattern"></a>Use variables in XPath expression or pattern</h2>
<p>If you need to use variables in your XPath expression or pattern, you can pass a map of variables as the last argument to your XPath operation.</p>
<p>The map key must implement the <a href="sigel.protocols.html#var-QNameable">QNameable</a> protocol. The value must implement the <a href="sigel.protocols.html#var-XMLValue">XMLValue</a> protocol.</p>
<p>If you use variables, you also need to pass in an <code>XPathCompiler</code> as the first argument, because setting a variable mutates the <code>XPathCompiler</code> instance.</p>
<p>Example:</p>
<pre><code>(def my-compiler (xpath/compiler))

(xpath/is? my-compiler "&lt;num&gt;1&lt;/num&gt;" "xs:integer(num) * $two eq 2" {:two 2})
</code></pre></div></div><div class="public anchor" id="var-*compiler*"><h3>*compiler*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>A default XPath compiler.</p>
<p>If you don’t pass in your own <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a> instance when compiling a stylesheet, Sigel uses this instance.</p></div></div></div><div class="public anchor" id="var--.3Eseq"><h3>-&gt;seq</h3><div class="usage"><code>(-&gt;seq node)</code></div><div class="doc"><div class="markdown"><p>Return a seq on the nodes in the given document.</p></div></div></div><div class="public anchor" id="var-compiler"><h3>compiler</h3><div class="usage"><code>(compiler processor default-namespace-uri namespaces)</code><code>(compiler)</code></div><div class="doc"><div class="markdown"><p>Make a new <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p>
<p>Optionally, give the default namespace and additional namespace declarations you want the XPathCompiler to know about.</p></div></div></div><div class="public anchor" id="var-declare-namespace.21"><h3>declare-namespace!</h3><div class="usage"><code>(declare-namespace! compiler prefix uri)</code><code>(declare-namespace! compiler ns-decl)</code></div><div class="doc"><div class="markdown"><p>Teach an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a> about a namespace.</p>
<p>You can give the namespace either as a string prefix and a string URI or as a Namespace record.</p></div></div></div><div class="public anchor" id="var-declare-variables.21"><h3>declare-variables!</h3><div class="usage"><code>(declare-variables! compiler variables)</code></div><div class="doc"><div class="markdown"><p>Declare variables on an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p>
<p>This function does not set the value of a variable. Rather, it tells the XPathCompiler that the value of a variable will be set later.</p></div></div></div><div class="public anchor" id="var-default-namespace"><h3>default-namespace</h3><div class="usage"><code>(default-namespace compiler)</code></div><div class="doc"><div class="markdown"><p>Get the default namespace URI of an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p></div></div></div><div class="public anchor" id="var-early-evaluation-context"><h3>early-evaluation-context</h3><div class="usage"><code>(early-evaluation-context static-context)</code></div><div class="doc"><div class="markdown"><p>Make a new XPath evaluation context from a static context.</p></div></div></div><div class="public anchor" id="var-is.3F"><h3>is?</h3><div class="usage"><code>(is? compiler context expression bindings)</code><code>(is? context expression)</code></div><div class="doc"><div class="markdown"><p>Given an XML context and an XPath expression, return a boolean that indicates whether the expression evaluates to true in that context.</p>
<p>Optionally, give a map of XPath variable bindings.</p>
<p>Example:</p>
<pre><code>(xpath/is? compiler "&lt;one&gt;1&lt;/one&gt;" "xs:int(one) + 2 eq 3")
; =&gt; true
</code></pre></div></div></div><div class="public anchor" id="var-match"><h3>match</h3><div class="usage"><code>(match compiler context pattern bindings)</code><code>(match context pattern)</code></div><div class="doc"><div class="markdown"><p>Return a sequence of values that match an XPath pattern in the given XML context.</p>
<p>Optionally, give a map of XPath variable bindings.</p>
<p>Example:</p>
<pre><code>(vec (xpath/match "&lt;nums&gt;&lt;num&gt;1&lt;/num&gt;&lt;num&gt;2&lt;/num&gt;&lt;num&gt;3&lt;/num&gt;&lt;/nums&gt;"
                  "num[xs:int(.) lt 3]"))
;;=&gt;
;;[#object[net.sf.saxon.s9api.XdmNode 0x51912c8 "&lt;num&gt;1&lt;/num&gt;"]
;; #object[net.sf.saxon.s9api.XdmNode 0x4cc3057a "&lt;num&gt;2&lt;/num&gt;"]]
</code></pre></div></div></div><div class="public anchor" id="var-matches.3F"><h3>matches?</h3><div class="usage"><code>(matches? compiler node pattern bindings)</code><code>(matches? node pattern)</code></div><div class="doc"><div class="markdown"><p>Check whether a node matches a XPath pattern (compiled with <a href="sigel.xpath.core.html#var-pattern">pattern</a>).</p></div></div></div><div class="public anchor" id="var-ns"><h3>ns</h3><div class="usage"><code>(ns prefix uri)</code></div><div class="doc"><div class="markdown"><p>Create a Namespace record composed of a string prefix and a string URI.</p></div></div></div><div class="public anchor" id="var-package-data"><h3>package-data</h3><div class="usage"><code>(package-data static-context)</code></div><div class="doc"><div class="markdown"><p>Get the package data of a StaticContext.</p></div></div></div><div class="public anchor" id="var-pattern"><h3>pattern</h3><div class="usage"><code>(pattern compiler string)</code><code>(pattern string)</code></div><div class="doc"><div class="markdown"><p>Make an XPath pattern from a string.</p></div></div></div><div class="public anchor" id="var-select"><h3>select</h3><div class="usage"><code>(select compiler context expression bindings)</code><code>(select context expression)</code></div><div class="doc"><div class="markdown"><p>Return a sequence of values that match an XPath expression in the given XML context.</p>
<p>Example:</p>
<pre><code>(def document "&lt;a&gt;&lt;b/&gt;&lt;c/&gt;&lt;/a&gt;")

(xpath/select document "a/b | a/c")

;;=&gt; #object[net.sf.saxon.s9api.XdmValue 0x157cb3cd "&lt;b/&gt;\\n&lt;c/&gt;"]

;; `select` returns an XdmValue, which is an Iterable, so you can use
;; Clojure's seq functions on the result.
(str (.getNodeName (first (xpath/select document "a/b | a/c"))))
;;=&gt; "b"
</code></pre></div></div></div><div class="public anchor" id="var-set-default-namespace.21"><h3>set-default-namespace!</h3><div class="usage"><code>(set-default-namespace! compiler uri)</code></div><div class="doc"><div class="markdown"><p>Set the default namespace URI of an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p>
<p>Setting the default namespace URI allows you to omit the namespace prefix from your XPath expressions.</p>
<p>Example:</p>
<pre><code>(def my-compiler (xpath/compiler))

(set-default-namespace! my-compiler "bar")

(xpath/select my-compiler "&lt;foo xmlns=\"bar\"&gt;&lt;baz/&gt;&lt;/foo&gt;" "foo/baz")
;;=&gt; #object[net.sf.saxon.s9api.XdmNode 0x2e91fb2b "&lt;baz xmlns=\"bar\"/&gt;"]
</code></pre></div></div></div><div class="public anchor" id="var-set-variable"><h3>set-variable</h3><div class="usage"><code>(set-variable selector [name value])</code></div><div class="doc"><div class="markdown"><p>Set a variable on an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathSelector.html">XPathSelector</a>.</p>
<p>The name of the variable must implement the <a href="null">saxon/QNameable</a> protocol.</p>
<p>The value of the variable must implement the <a href="null">saxon/XmlValue</a> protocol.</p></div></div></div><div class="public anchor" id="var-static-context"><h3>static-context</h3><div class="usage"><code>(static-context compiler)</code></div><div class="doc"><div class="markdown"><p>Get the static context of an <a href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/s9api/XPathCompiler.html">XPathCompiler</a>.</p></div></div></div><div class="public anchor" id="var-value-of"><h3>value-of</h3><div class="usage"><code>(value-of compiler context expression bindings)</code><code>(value-of context expression)</code></div><div class="doc"><div class="markdown"><p>Return the value of an XPath expression evaluated in the given context.</p>
<p>If the value is an atomic value, return the value as a Java object of the equivalent type. If it’s a node, get the string value of the node.</p>
<p>Example:</p>
<pre><code>(xpath/value-of "&lt;num&gt;1&lt;/num&gt;" "xs:int(num)")
;;=&gt; 1
</code></pre></div></div></div></div></body></html>